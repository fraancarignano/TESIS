<div class="modal-overlay" (click)="cancelar()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="header-content">
        <div class="icon-badge">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 21h18"></path>
            <path d="M5 21V7l8-4v18"></path>
            <path d="M19 21V11l-6-4"></path>
          </svg>
        </div>
        <div class="header-text">
          <h2>{{ titulo }}</h2>
          <p class="subtitle">{{ esEdicion ? 'Actualiza los datos del taller externo' : 'Ingresa los datos del nuevo taller externo' }}</p>
        </div>
      </div>
      <button class="btn-close" (click)="cancelar()" aria-label="Cerrar">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="formulario" (ngSubmit)="guardar()">
        <div class="form-section">
          <h3 class="section-title">Datos del taller</h3>

          <div class="form-row">
            <div class="form-field">
              <label for="nombreTaller">Nombre del Taller <span class="required">*</span></label>
              <div class="input-wrapper">
                <input type="text" id="nombreTaller" formControlName="nombreTaller" placeholder="Taller Norte" [class.error]="tieneError('nombreTaller')">
              </div>
              <span class="error-message" *ngIf="tieneError('nombreTaller')">{{ obtenerMensajeError('nombreTaller') }}</span>
            </div>

            <div class="form-field">
              <label for="tipoTaller">Tipo de Taller</label>
              <div class="input-wrapper">
                <input type="text" id="tipoTaller" formControlName="tipoTaller" placeholder="Confeccion, bordado, estampado...">
              </div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">Contacto</h3>

          <div class="form-row">
            <div class="form-field">
              <label for="responsable">Responsable</label>
              <div class="input-wrapper">
                <input type="text" id="responsable" formControlName="responsable" placeholder="Nombre y apellido">
              </div>
            </div>

            <div class="form-field">
              <label for="telefono">Numero telefonico</label>
              <div class="input-wrapper">
                <input type="tel" id="telefono" formControlName="telefono" placeholder="+54 351 123-4567">
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field full-width">
              <label for="email">Mail</label>
              <div class="input-wrapper">
                <input type="email" id="email" formControlName="email" placeholder="contacto@taller.com" [class.error]="tieneError('email')">
              </div>
              <span class="error-message" *ngIf="tieneError('email')">{{ obtenerMensajeError('email') }}</span>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">Ubicacion</h3>

          <div class="form-row">
            <div class="form-field">
              <label for="idProvincia">Provincia <span class="required">*</span></label>
              <div class="input-wrapper">
                <select id="idProvincia" formControlName="idProvincia">
                  <option [ngValue]="null">Seleccione provincia</option>
                  <option *ngFor="let provincia of provincias" [ngValue]="provincia.idProvincia">
                    {{ provincia.nombre }}
                  </option>
                </select>
              </div>
              <span class="error-message" *ngIf="tieneError('idProvincia')">{{ obtenerMensajeError('idProvincia') }}</span>
            </div>

            <div class="form-field">
              <label for="idCiudad">Ciudad <span class="required">*</span></label>
              <div class="input-wrapper">
                <select id="idCiudad" formControlName="idCiudad" [disabled]="!formulario.get('idProvincia')?.value">
                  <option [ngValue]="null">Seleccione ciudad</option>
                  <option *ngFor="let ciudad of ciudades" [ngValue]="ciudad.idCiudad">
                    {{ ciudad.nombre }}
                  </option>
                </select>
              </div>
              <span class="error-message" *ngIf="tieneError('idCiudad')">{{ obtenerMensajeError('idCiudad') }}</span>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field full-width">
              <label for="direccion">Direccion</label>
              <div class="input-wrapper">
                <input type="text" id="direccion" formControlName="direccion" placeholder="Calle 123, Ciudad">
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="formulario.invalid">
            {{ esEdicion ? 'Actualizar taller' : 'Registrar taller' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
